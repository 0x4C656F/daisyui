.menu {
  @apply p-2 flex w-fit flex-col flex-wrap;
  font-size: 0.875rem;

  :where(li ul) {
    @apply ms-4 ps-2 relative whitespace-nowrap;

    &:before {
      @apply bg-base-content start-0 top-3 bottom-3 w-px absolute opacity-10;
      content: "";
    }
  }

  :where(li > .menu-dropdown:not(.menu-dropdown-show)) {
    @apply hidden;
  }

  :where(li:not(.menu-title) > *:not(ul, details, .menu-title, .btn)),
  :where(li:not(.menu-title) > details > summary:not(.menu-title)) {
    @apply rounded-field gap-2 px-4 py-2 grid grid-flow-col content-start items-center text-start;
    transition-property: color, background-color, box-shadow;
    transition-duration: 0.2s;
    transition-timing-function: cubic-bezier(0, 0, 0.2, 1);
    grid-auto-columns: minmax(auto, max-content) auto max-content;
    text-wrap: balance;
    user-select: none;
  }

  :where(li > details > summary) {
    @apply outline-hidden;

    &::-webkit-details-marker {
      @apply hidden;
    }
  }

  :where(li > details > summary),
  :where(li > .menu-dropdown-toggle) {
    &:after {
      @apply justify-self-end;
      display: block;
      height: 0.375rem;
      width: 0.375rem;
      rotate: -135deg;
      translate: 0 -1px;
      transition-property: rotate, translate;
      transition-duration: 0.2s;
      content: "";
      transform-origin: 50% 50%;
      box-shadow: 2px 2px inset;
      pointer-events: none;
    }
  }

  :where(li > details[open] > summary):after,
  :where(li > .menu-dropdown-toggle.menu-dropdown-show):after {
    rotate: 45deg;
    translate: 0 1px;
  }

  :where(li:not(.menu-title, .disabled) > *:not(ul, details, .menu-title)),
  :where(li:not(.menu-title, .disabled) > details > summary:not(.menu-title)) {
    &:not(.menu-active, :active, .btn) {
      &.menu-focus,
      &:focus-visible {
        @apply bg-base-content/10 text-base-content outline-hidden cursor-pointer;
      }

      &:hover {
        @apply bg-base-content/10 outline-hidden cursor-pointer;
        box-shadow:
          0 1px oklch(0% 0 0 / 0.01) inset,
          0 -1px oklch(100% 0 0 / 0.01) inset;
      }
    }
  }

  :where(li:empty) {
    @apply bg-base-content opacity-10;
    margin: 0.5rem 1rem;
    height: 1px;
  }

  :where(li) {
    @apply relative flex shrink-0 flex-col flex-wrap items-stretch;

    .badge {
      @apply justify-self-end;
    }

    & > *:not(ul, .menu-title, details, .btn):active,
    & > *:not(ul, .menu-title, details, .btn).menu-active,
    & > details > summary:active {
      @apply bg-neutral text-neutral-content bg-neutral text-neutral-content outline-hidden;
      box-shadow: 0 2px 3px -2px var(--color-neutral);
    }

    &.menu-disabled {
      @apply text-base-content/20 pointer-events-none;
    }
  }
}

.menu-title {
  @apply text-base-content/40 px-4 py-2;
  font-size: 0.875rem;
  font-weight: 600;
}

.menu-horizontal {
  @apply inline-flex flex-row;

  & > li:not(.menu-title) > details > ul {
    @apply ms-0 mt-4 py-2 pe-2 absolute;
  }

  & > li > details > ul {
    &:before {
      content: none;
    }
  }

  :where(& > li:not(.menu-title) > details > ul) {
    @apply bg-base-100 rounded-box;
    box-shadow:
      0 1px 3px 0 oklch(0% 0 0/0.1),
      0 1px 2px -1px oklch(0% 0 0/0.1);
  }
}

.menu-vertical {
  @apply inline-flex flex-col;

  & > li:not(.menu-title) > details > ul {
    @apply ms-4 mt-0 py-0 pe-0 relative;
  }
}

.menu-xs {
  :where(li:not(.menu-title) > *:not(ul, details, .menu-title)),
  :where(li:not(.menu-title) > details > summary:not(.menu-title)) {
    @apply rounded-field px-2 py-1;
    font-size: 0.6875rem;
  }

  .menu-title {
    @apply px-2 py-1;
  }
}

.menu-sm {
  :where(li:not(.menu-title) > *:not(ul, details, .menu-title)),
  :where(li:not(.menu-title) > details > summary:not(.menu-title)) {
    @apply rounded-field px-3 py-1;
    font-size: 0.75rem;
  }

  .menu-title {
    @apply px-3 py-2;
  }
}

.menu-md {
  :where(li:not(.menu-title) > *:not(ul, details, .menu-title)),
  :where(li:not(.menu-title) > details > summary:not(.menu-title)) {
    @apply rounded-field px-4 py-2;
    font-size: 0.875rem;
  }

  .menu-title {
    @apply px-4 py-2;
  }
}

.menu-lg {
  :where(li:not(.menu-title) > *:not(ul, details, .menu-title)),
  :where(li:not(.menu-title) > details > summary:not(.menu-title)) {
    @apply rounded-field px-6 py-3;
    font-size: 1.125rem;
  }

  .menu-title {
    @apply px-6 py-3;
  }
}

.menu-xl {
  :where(li:not(.menu-title) > *:not(ul, details, .menu-title)),
  :where(li:not(.menu-title) > details > summary:not(.menu-title)) {
    @apply rounded-field px-6 py-3;
    font-size: 1.375rem;
  }

  .menu-title {
    @apply px-6 py-3;
  }
}
